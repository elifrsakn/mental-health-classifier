import pandas as pd
from sklearn.preprocessing import LabelEncoder
import joblib

# ğŸ“¥ Veri dosyasÄ±nÄ± oku
df_path = "/Users/elifsakin/Downloads/Combined_Data.csv"
df = pd.read_csv(df_path)

# ğŸ” SÃ¼tun adlarÄ±nÄ± kontrol et
print("ğŸ“‹ Mevcut sÃ¼tunlar:", df.columns.tolist())

# ğŸ§  Tahmini etiket sÃ¼tunu: string olan ve 2-50 unique deÄŸeri olan sÃ¼tunlardan biri
candidate_columns = [
    col for col in df.columns
    if df[col].dtype == 'object' and 2 <= df[col].nunique() <= 50
]

# âœ… Ä°lk eÅŸleÅŸeni etiket olarak al
if candidate_columns:
    label_col = candidate_columns[0]
    print(f"âœ… Etiket sÃ¼tunu bulundu: '{label_col}'")
else:
    raise ValueError("âŒ Etiket sÃ¼tunu bulunamadÄ±. LÃ¼tfen dosyanÄ±n iÃ§eriÄŸini kontrol et.")

# ğŸ¯ LabelEncoder uygula
le = LabelEncoder()
le.fit(df[label_col])

# ğŸ’¾ Kaydet
encoder_path = "/Users/elifsakin/Desktop/proje_final/label_encoder.pkl"
joblib.dump(le, encoder_path)

print("âœ… LabelEncoder baÅŸarÄ±yla kaydedildi:", encoder_path)
print("ğŸ”¢ SÄ±nÄ±f eÅŸleÅŸmeleri:")
print(dict(enumerate(le.classes_)))
